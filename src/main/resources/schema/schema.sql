
-- <회원정보>
CREATE TABLE Delievery_Service.USER_BASE(
  USER_NUM           INT(10)       NOT NULL AUTO_INCREMENT,
  ID                VARCHAR(20)   NOT NULL,
  STATUS            VARCHAR(10)   NOT NULL DEFAULT 'DEFAULT',
  PASSWORD          VARCHAR(100)  NOT NULL,
  NAME              VARCHAR(10)   DEFAULT NULL,

  MOBILE_NUM        VARCHAR(15)   NOT NULL,
  BIRTHDAY         DATETIME      DEFAULT NULL,
  ADDRESS_CODE      INT(10)       DEFAULT NULL,
  ADDRESS_DETAIL    VARCHAR(20)   DEFAULT NULL,
  DATE_CREATION     DATETIME      DEFAULT NOW(),
  DATE_UPDATE       DATETIME,

  PRIMARY KEY (USER_NUM),
  FOREIGN KEY (ADDRESS_CODE) REFERENCES ADDRESS(PID_ADDRESS_CODE)
)


-- <주소>
-- 공공데이터(건물주소 DB) 저장 계획. 추가로 거리를 계산하기 위한 좌표 값 필요
-- http://www.juso.go.kr/addrlink/addressBuildDevNew.do?menu=rdnm
CREATE TABLE Delievery_Service.ADDRESS(
  PID_ADDRESS_CODE	  INT(10) NOT NULL AUTO_INCREMENT,
  CITY_NAME	          VARCHAR(40),
  COUNTRY_NAME	      VARCHAR(40),
  ROAD_CODE	          VARCHAR(40),
  ROAD_NAME	          VARCHAR(40),

  UNDERGROUND_STATUS	VARCHAR(1),
  BUILDING_MNG_CODE	  VARCHAR(25),
  BUILDING_NUMBER	    INT(5),
  BUILDING_NUMBER_SIDE	INT(5),
  BUILDING_NAME	      VARCHAR(40),

  BUILDING_NAME_DETAIL	VARCHAR(40),
  TOWN_CODE	          VARCHAR(20),
  ADMINISTRATION_CODE	VARCHAR(20),
  ADMINISTRATION_COUNTRY_CODE	VARCHAR(20),
  POSTAL_CODE	        VARCHAR(20),

  RSN_TRANSFER_CODE	  VARCHAR(20),
  NOTICE_DATE	        DATETIME,
  APARTMENT_HOUSE_STATUS	INT(1),
  ADDRESS_DETAIL_STATUS	INT(1),
  COMMENT1	          VARCHAR(100),
  COMMENT2	          VARCHAR(100),

  PRIMARY KEY(PID_ADDRESS_CODE)
)

-- <주문>
CREATE TABLE Delievery_Service.ORDERS(
  ORDER_NUM	            INT(10)      NOT NULL AUTO_INCREMENT,
  DATE_CREATION	        DATETIME     DEFAULT NOW(),
  ORDER_STATUS	        VARCHAR(10)  DEFAULT '매칭 대기중',
  ARRIVAL_TIME	        DATETIME,
  EX_ARRIVAL_TIME	      DATETIME,

  USER_ID	              VARCHAR(20)  NOT NULL,
  DELIVERY_ID	          VARCHAR(20)  DEFAULT NULL,
  DEPARTURE_ADDRESS_CODE	    INT(10)      NOT NULL,
  DEPARTURE_ADDRESS_DETAIL	  VARCHAR(100) NOT NULL,
  DESTINATION_ADDRESS_CODE	    INT(10)      NOT NULL,
  DESTINATION_ADDRESS_DETAIL	  VARCHAR(100) NOT NULL,
  DISTANCE              DECIMAL (4,2) DEFAULT 0.00,

PRIMARY KEY(ORDER_NUM),
FOREIGN KEY(DEPARTURE_ADDRESS_CODE) REFERENCES ADDRESS(PID_ADDRESS_CODE),
FOREIGN KEY(DESTINATION_ADDRESS_CODE) REFERENCES ADDRESS(PID_ADDRESS_CODE),
)

-- <배달원 정보>
CREATE TABLE Delievery_Service.DELIVERY_MAN_BASE(
  DELIVERY_NUM  INT(10) NOT NULL AUTO_INCREMENT,
  ID	          VARCHAR(20) NOT NULL,
  STATUS	      VARCHAR(10) NOT NULL DEFAULT 'DEFAULT',
  PASSWORD	    VARCHAR(100) NOT NULL,
  NAME	        VARCHAR(10) NOT NULL,

  MOBILE_NUM	  VARCHAR(15) NOT NULL,
  BIRTHDAY	    DATETIME NOT NULL,
  DATE_CREATION	DATETIME DEFAULT NOW(),
  DATE_UPDATE	  DATETIME,

  PRIMARY KEY (DELIVERY_NUM)
)

-- <배달물품 정보>
CREATE TABLE Delievery_Service.PRODUCTS_INFO(
  PRODUCT_NUM	  INT(10) NOT NULL AUTO_INCREMENT,
  CATEGORY	    VARCHAR(20) NOT NULL,
  BRAND_NAME	  VARCHAR(20) NOT NULL,
  PRODUCT_NAME	VARCHAR(20) NOT NULL,
  COMMENT	      VARCHAR(200) DEFAULT NULL,

  ORDER_NUM	    INT(10) NOT NULL,
  DATE_CREATION	DATETIME DEFAULT NOW(),
  DATE_UPDATE	  DATETIME,

  PRIMARY KEY(PRODUCT_NUM),
  FOREIGN KEY(ORDER_NUM) REFERENCES ORDERS(ORDER_NUM)
)

-- <결제정보>
CREATE TABLE Delievery_Service.PAYMENT(
PAYMENT_NUM     INT(10)       NOT NULL AUTO_INCREMENT,
PAYMENT_TYPE 		VARCHAR(255),
AMOUNT 					INT(8),
ORDER_NUM 			INT(10) NOT NULL,
PAYMENT_STATUS 	VARCHAR(255),
DATE_CREATION 	DATETIME DEFAULT NOW(),
DATE_UPDATE   	DATETIME,
DELIVERY_TYPE   VARCHAR(255)

PRIMARY KEY(PAYMENT_NUM),
FOREIGN KEY(ORDER_NUM) REFERENCES ORDERS(ORDER_NUM),
FOREIGN KEY(DELIVERY_TYPE) REFERENCES FEE(DELIVERY_TYPE)
)

-- <요금정보>
-- 'DELIVERY_TYPE'을 PK로 지정한 이유는 다양한 배달종류가 나오지 않을거라 생각했기 때문입니다. 따라서 불필요하게 PK 값을 auto_increment 활용해 제공해줄 필요가 없다고 생각했습니다.
CREATE TABLE Delievery_Service.FEE(
DELIVERY_TYPE  VARCHAR(255),
BASIC_DISTANCE DECIMAL(4,2) NOT NULL,
BASIC_FEE      INT(5) NOT NULL,
EXTRA_DISTANCE DECIMAL(4,2) NOT NULL,
EXTRA_FEE      INT(5) NOT NULL,
PRIMARY KEY(DELIVERY_TYPE)
)