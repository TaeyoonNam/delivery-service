
-- <회원정보>
CREATE TABLE Delievery_Service.USER_BASE(
  PID_NUM           INT(10)       NOT NULL AUTO_INCREMENT,
  ID                VARCHAR(20)   NOT NULL,
  STATUS            VARCHAR(10)   NOT NULL DEFAULT 'DEFAULT',
  PASSWORD          VARCHAR(100)  NOT NULL,
  NAME              VARCHAR(10)   DEFAULT NULL,

  MOBILE_NUM        VARCHAR(15)   NOT NULL,
  BIRTHDATE         DATETIME      DEFAULT NULL,
  ADDRESS_CODE      INT(10)       DEFAULT NULL,
  ADDRESS_DETAIL    VARCHAR(20)   DEFAULT NULL,
  DATE_CREATION     DATETIME      DEFAULT NOW(),
  DATE_UPDATE       DATETIME,

  PRIMARY KEY (PID_NUM),
  FOREIGN KEY (ADDRESS_CODE) REFERENCES ADDRESS(PID_ADDRESS_CODE)
)


-- <주소>
-- 공공데이터(건물주소 DB) 저장 계획. 추가로 거리를 계산하기 위한 좌표 값 필요
-- http://www.juso.go.kr/addrlink/addressBuildDevNew.do?menu=rdnm
CREATE TABLE Delievery_Service.ADDRESS(
  PID_ADDRESS_CODE	  INT(10) NOT NULL AUTO_INCREMENT,
  CITY_NAME	          VARCHAR(40),
  COUNTRY_NAME	      VARCHAR(40),
  ROAD_CODE	          VARCHAR(40),
  ROAD_NAME	          VARCHAR(40),

  UNDERGROUND_STATUS	VARCHAR(1),
  BUILDING_MNG_CODE	  VARCHAR(25),
  BUILDING_NUMBER	    INT(5),
  BUILDING_NUMBER_SIDE	INT(5),
  BUILDING_NAME	      VARCHAR(40),

  BUILDING_NAME_DETAIL	VARCHAR(40),
  TOWN_CODE	          VARCHAR(20),
  ADMINISTRATION_CODE	VARCHAR(20),
  ADMINISTRATION_COUNTRY_CODE	VARCHAR(20),
  POSTAL_CODE	        VARCHAR(20),

  RSN_TRANSFER_CODE	  VARCHAR(20),
  NOTICE_DATE	        DATETIME,
  APARTMENT_HOUSE_STATUS	INT(1),
  ADDRESS_DETAIL_STATUS	INT(1),
  COMMENT1	          VARCHAR(100),
  COMMENT2	          VARCHAR(100),

  PRIMARY KEY(PID_ADDRESS_CODE)
)

-- <주문>
CREATE TABLE Delievery_Service.ORDERS(
  ORDER_NUM	            INT(10)      NOT NULL AUTO_INCREMENT,
  DATE_CREATION	        DATETIME     DEFAULT NOW(),
  ORDER_STATUS	        VARCHAR(10)  DEFAULT '매칭 대기중',
  ARRIVAL_TIME	        DATETIME,
  EX_ARRIVAL_TIME	      DATETIME,

  USER_NUM	            INT(10)  NOT NULL,
  DELIVERY_NUM	        INT(10)  DEFAULT NULL,
  DPRT_ADDRESS_CODE	    INT(10)      NOT NULL,
  DPRT_ADDRESS_DETAIL	  VARCHAR(100) NOT NULL,
  DEST_ADDRESS_CODE	    INT(10)      NOT NULL,
  DEST_ADDRESS_DETAIL	  VARCHAR(100) NOT NULL,

PRIMARY KEY(ORDER_NUM),
FOREIGN KEY(DPRT_ADDRESS_CODE) REFERENCES ADDRESS(PID_ADDRESS_CODE),
FOREIGN KEY(DEST_ADDRESS_CODE) REFERENCES ADDRESS(PID_ADDRESS_CODE),
FOREIGN KEY(USER_NUM) REFERENCES USER_BASE(PID_NUM),
FOREIGN KEY(DELIVERY_NUM) REFERENCES DELIVERY_BASE(PID_NUM)
)

-- <배달원 정보>
CREATE TABLE Delievery_Service.DELIVERY_MAN_BASE(
  PID_NUM	      INT(10) NOT NULL AUTO_INCREMENT,
  ID	          VARCHAR(20) NOT NULL,
  STATUS	      VARCHAR(10) NOT NULL DEFAULT 'DEFAULT',
  PASSWORD	    VARCHAR(100) NOT NULL,
  NAME	        VARCHAR(10) NOT NULL,

  MOBILE_NUM	  VARCHAR(15) NOT NULL,
  BIRTHDATE	    DATETIME NOT NULL,
  DATE_CREATION	DATETIME DEFAULT NOW(),
  DATE_UPDATE	  DATETIME,

  PRIMARY KEY (PID_NUM)
)

-- <배달물품 정보>
CREATE TABLE Delievery_Service.PRODUCTS_INFO(
  PRODUCT_NUM	  INT(10) NOT NULL AUTO_INCREMENT,
  CATEGORY	    VARCHAR(20) NOT NULL,
  BRAND_NAME	  VARCHAR(20) NOT NULL,
  PRODUCT_NAME	VARCHAR(20) NOT NULL,
  COMMENT	      VARCHAR(200) DEFAULT NULL,

  ORDER_NUM	    INT(10),
  DATE_CREATION	DATETIME DEFAULT NOW(),
  DATE_UPDATE	  DATETIME,

  PRIMARY KEY(PRODUCT_NUM),
  FOREIGN KEY(ORDER_NUM) REFERENCES ORDERS(ORDER_NUM)
)
